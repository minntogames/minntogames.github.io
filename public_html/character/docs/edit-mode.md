# 編集モード

編集モードでは、キャラクターの選択や並び替えを行うことができます。

## 編集モードの起動

### 起動方法
1. ハンバーガーメニュー（☰）を開く
2. 「編集モード: オフ」をクリック
3. 編集ツールバーが表示されます

### 終了方法
1. ハンバーガーメニューを開く
2. 「編集モード: オン」を再度クリック
3. または、ページをリロード

## サブモード

編集モードには2つのサブモードがあります。

### サブモードの切り替え
編集ツールバーの左側にあるボタンで切り替えます:
- **選択** ボタン（チェックマークアイコン）
- **並び替え** ボタン（グリッドアイコン）

## 選択モード

キャラクターを選択して一括操作を行うモードです。

### 使い方

#### 1. キャラクターの選択
- カードをクリックして選択/解除
- 選択されたカードは枠線が表示されます
- 左上にチェックマークが表示されます

#### 2. 全選択/選択解除
- **全選択** ボタン: 現在表示中の全キャラクターを選択
- **選択解除** ボタン: 全ての選択を解除

#### 3. 選択数の確認
ツールバーに「○件選択中」と表示されます。

### 一括タグ追加

複数のキャラクターに一度にカスタムタグを追加できます。

#### 手順
1. キャラクターを選択（1件以上）
2. 「一括タグ追加」ボタンをクリック
3. ポップアップが表示されます

#### タグの追加
**新しいタグを追加:**
1. 「新しいタグを作成」セクション
2. タグ名を入力
3. 色を選択（またはカラーピッカーで指定）
4. 「追加」をクリック

**既存のタグを追加:**
1. 「既存のタグから選択」セクション
2. タグ名をクリック
3. 選択されたタグにチェックマークが表示されます
4. 複数選択可能

#### タグの削除
**既存のタグを削除:**
1. 「既存のタグから選択」セクション
2. チェックが入っているタグを再度クリック
3. チェックが外れ、削除対象になります

#### 適用
1. タグの選択/作成が完了したら「適用」ボタンをクリック
2. 選択した全てのキャラクターにタグが追加/削除されます
3. 成功メッセージが表示されます

#### キャンセル
「キャンセル」ボタンまたは×ボタンで変更を破棄します。

### 注意事項
- フィルターが適用されている場合、表示中のキャラクターのみが選択対象
- 編集モードを終了すると選択はクリアされます
- 選択状態は並び替えモードに切り替えると解除されます

## 並び替えモード

ドラッグ&ドロップでカードの並び順を変更するモードです。

### 使い方

#### 1. 並び替えモードの開始
1. 編集ツールバーの「並び替え」ボタンをクリック
2. カードがドラッグ可能になります
3. カーソルが「移動」カーソルに変わります

#### 2. カードの移動
**PCの場合:**
1. カードをクリックしてドラッグ
2. 目的の位置までマウスを移動
3. マウスを離して配置

**モバイルの場合:**
1. カードを長押し
2. 目的の位置までドラッグ
3. 指を離して配置

#### 3. 並び順の保存
1. 「並び順を保存」ボタンをクリック
2. 現在の並び順が保存されます
3. 成功メッセージが表示されます

#### 4. キャンセル
「キャンセル」ボタンで変更を破棄し、選択モードに戻ります。

### 並び順の適用範囲

#### グローバル並び順
フィルターを適用していない場合、全体の並び順として保存されます。
- 保存先: localStorage (`customCharacterOrder`)
- 並び順モード: 自動的に「カスタム」に切り替わります

#### タグごとの並び順
カスタムタグフィルターを**1つだけ**適用している場合、そのタグ専用の並び順として保存されます。
- 保存先: localStorage (`tagCustomOrders[タグID]`)
- そのタグでフィルターした時のみ適用されます
- タグごとに異なる並び順を設定可能

**例:**
1. 「お気に入り」タグでフィルター
2. 並び替えて保存
3. → 「お気に入り」タグ専用の並び順が保存される

#### 注意事項
- 複数のカスタムタグでフィルター中は、グローバル並び順として保存されます
- 世界・種族などの基本フィルターは並び順の保存先に影響しません

### ドラッグ中の視覚効果
- ドラッグ中のカードは半透明になります
- ドラッグ中のカードは少し縮小します
- 配置可能な位置が視覚的に示されます

### リサイズ対応
並び替えモード中にウィンドウをリサイズしても、編集中の並び順は保持されます。

### 制限事項
- 並び替えモード中はカードの詳細表示ができません
- フィルター条件を変更すると、編集中の並び順はリセットされます
- キャラクターが表示されていない場合、並び替えモードを開始できません

## 編集モードのショートカット

### 選択モード
- `カードクリック` - 選択/解除の切り替え
- `全選択ボタン` - 全てのカードを選択
- `選択解除ボタン` - 全ての選択を解除

### 並び替えモード
- `ドラッグ&ドロップ` - カードの移動
- `並び順を保存` - 現在の並び順を保存
- `キャンセル` - 変更を破棄

## トラブルシューティング

### 選択モードで選択できない
1. 編集モードがオンになっているか確認
2. 「選択」サブモードが選択されているか確認
3. カードが表示されているか確認

### 並び替えができない
1. 編集モードがオンになっているか確認
2. 「並び替え」サブモードが選択されているか確認
3. カードが表示されているか確認
4. ブラウザがドラッグ&ドロップに対応しているか確認

### 並び順が保存されない
1. localStorageが有効か確認
2. プライベートモードでないか確認
3. ブラウザのストレージ容量を確認

### リサイズで並び順がリセットされる
修正済み（v2.0以降）。それ以前のバージョンの場合はアップデートしてください。

### モバイルでドラッグできない
1. 長押ししてからドラッグしてください
2. スクロールとドラッグを区別するため、しっかり長押しが必要です
3. ブラウザがタッチイベントに対応しているか確認

## ベストプラクティス

### 効率的な選択
1. フィルターで絞り込んでから選択
2. 全選択→不要なものだけ解除、の方が速い場合も
3. 選択数を確認しながら作業

### 並び替えのコツ
1. 重要なキャラクターを上部に配置
2. グループごとにまとめて配置
3. タグごとに異なる並び順を設定すると便利

### データ保護
1. 重要な並び順は定期的にエクスポート
2. ブラウザのデータ削除前にバックアップ
3. 複数ブラウザで使用する場合は同期に注意
